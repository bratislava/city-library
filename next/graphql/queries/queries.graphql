# Write your query or mutation here
# TODO refactor - move footer to fragment and get rid of unused data
query Footer($locale: I18NLocaleCode!) {
  footer(locale: $locale) {
    data {
      id
      attributes {
        footerColumns {
          id
          title
          footerLink {
            id
            title
            otherSite
            redirectTo {
              data {
                ...BasePageFields
              }
            }
          }
        }
        siteMapLink {
          data {
            ...BasePageFields
          }
        }
        privacyLink {
          data {
            ...BasePageFields
          }
        }
        copyrightText
      }
    }
  }
}

query HomePage($locale: I18NLocaleCode!) {
  homePage(locale: $locale) {
    data {
      attributes {
        faqSection {
          id
          title
          redirectTo {
            data {
              ...BasePageFields
            }
          }
          faqs {
            id
            question
            answer
          }
          ctas {
            id
            title
            ctaRedirectTo {
              data {
                ...BasePageFields
              }
            }
          }
        }
        registrationInfoSection {
          id
          title
          description
          redirectTo {
            data {
              ...BasePageFields
            }
          }
          registrationBenefits {
            id
            benefit
          }
        }
        newsSection {
          id
          title
          redirectTo {
            data {
              ...BasePageFields
            }
          }
        }
        localizations {
          data {
            attributes {
              locale
            }
          }
        }
        Seo {
          id
          metaTitle
          metaDescription
          keywords
          metaRobots
          metaViewport
          canonicalURL
        }
      }
    }
  }
    menus(locale: $locale, sort: ["order:asc"]) {
    data {
      ...Menu
    }
  }
  footer(locale: $locale) {
    data {
      id
      attributes {
        footerColumns {
          id
          title
          footerLink {
            id
            redirectTo {
              data {
                ...BasePageFields
              }
            }
            title
            otherSite
          }
        }
        siteMapLink {
          data {
            ...BasePageFields
          }
        }
        privacyLink {
          data {
            ...BasePageFields
          }
        }
      }
    }
  }
}

query BookTags {
  bookTags {
    data {
      attributes {
        displayName
        slug
      }
    }
  }
}

query Premises($locale: I18NLocaleCode!) {
  premises(locale: $locale) {
    data {
      attributes {
        title
        address
        url
        image {
          data {
            attributes {
              width
              height
              url
              alternativeText
            }
          }
        }
      }
      }
    }
}

query Menus($locale: I18NLocaleCode!) {
  menus(locale: $locale, sort: ["order:asc"]) {
    data {
      ...Menu
    }
  }
}

fragment Menu on MenuEntity {
  id
  attributes {
    menuTitle
    menuSlug
    menuTotalColumns
    order
    menuSections {
      ...MenuSection
    }
    createdAt
    updatedAt
  }
}

fragment MenuSection on ComponentMenuSections {
  id
  sectionTitle
  sectionColumnSpan
  sectionPage {
    data {
      ...BasePageFields
    }
  }
  sectionLinks {
    id
    sectionLinkTitle
    sectionLinkPage {
      data {
        ...SectionLinkPage
      }
    }
  }
}

query PromotedPages($locale: I18NLocaleCode!) {
  pages(
    filters: { promoted: {eq: true}, or: [{ layout: {eq: "event"} }, { layout: {eq: "announcement"} }, { layout: {eq: "news"} }] }
    locale: $locale
  ) {
    data {
      ...Page
    }
  }
}

query PromotedEvents($locale: I18NLocaleCode!) {
  pages(filters: { promoted: {eq: true}, layout: {eq: "event"} }, locale: $locale) {
    data {
      ...Page
    }
  }
}

query ListEvents($locale: I18NLocaleCode!, $start: Int, $limit: Int) {
  pages(filters: { layout: {eq: "event"} }, locale: $locale, pagination: { start: $start, limit: $limit }) {
    data {
      ...PageEvent
    }
  }
}

query PagesByLayout($layout: String!, $locale: I18NLocaleCode!, $start: Int, $limit: Int) {
  pages(filters: { layout: { eq: $layout } }, locale: $locale, pagination: { start: $start, limit: $limit }) {
    data {
      ...Page
    }
  }
}

query PagesByLayoutWithFieldPagination($layout: String!, $locale: I18NLocaleCode!, $start: Int, $limit: Int, $sort: String!) {
  pages(filters: { layout: { eq: $layout } }, locale: $locale, pagination: { start: $start, limit: $limit }, sort: [$sort]) {
    data {
      ...Page
    }
    meta {
      pagination {
        ...Pagination
      }
    }
  }
}

query PageBySlug($slug: String!, $locale: I18NLocaleCode!) {
  pages(filters: { slug: {eq: $slug} }, locale: $locale) {
    data {
      ...Page
    }
  }
  menus(locale: $locale, sort: ["order:asc"]) {
    data {
      ...Menu
    }
  }
  footer(locale: $locale) {
    data {
      id
      attributes {
        footerColumns {
          id
          title
          footerLink {
            id
            redirectTo {
              data {
                ...BasePageFields
              }
            }
            title
            otherSite
          }
        }
        siteMapLink {
          data {
            ...BasePageFields
          }
        }
        privacyLink {
          data {
            ...BasePageFields
          }
        }
      }
    }
  }
}

# strapi returns just the default locale if no locale is provided
# easiest way to get all static paths is to ask for all locales sequentially
query PagesStaticPaths($locale: I18NLocaleCode) {
  pages(locale: $locale) {
    data {
      id
      attributes {
        slug
        locale
      }
    }
  }
}

fragment Page on PageEntity {
  id
  attributes {
    slug
    title
    createdAt
    updatedAt
    date_added
    listingImage {
      data {
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
        }
      }
    }
    layout
    description
    pageCategory {
      data {
        ...PageCategory
      }
    }
    sections {
      ...Sections
    }
    blogPosts {
      data {
        ...BlogPost
      }
    }

    locale
    localizations {
      data {
        ...Localization
      }
    }
    Seo {
      id
      metaTitle
      metaDescription
      keywords
      metaRobots
      metaViewport
      canonicalURL
    }
  }
}

fragment PageCategory on CategoryEntity {
  attributes {
    ...Category

    subCategories {
      data {
        id
        attributes {
          ...Category
        }
      }
    }

    parentCategory {
      data {
        id
        attributes {
          ...Category
          parentCategory {
            data {
              id
              attributes {
                ...Category
              }
            }
          }
        }
      }
    }
  }
}

fragment Category on Category {
  title
  priority
  pages {
    ...PageLink
  }
  pageLink {
    ...PageLink
  }
  createdAt
  updatedAt
}

fragment Sections on PageSectionsDynamicZone {
  __typename
  ... on ComponentSectionsSubListing {
    id
    title
    url
  }

  ... on ComponentSectionsFaq {
    id
    title
    questions {
      ...AccordionItem
    }
  }
  ... on ComponentSectionsFlatTextCenter {
    id
    content
    image {
      data {
        id
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
          alternativeText
        }
      }
    }
  }
  ... on ComponentSectionsFlatText {
    id
    content
    media {
      data {
        id
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
          alternativeText
        }
      }
    }
  }
  ... on ComponentSectionsSiteUsefullness {
    id
    title
    thankYouMessage
  }
  ... on ComponentSectionsForm {
    id
    type
  }
  ... on ComponentSectionsSubpages {
    id
    ...Subpages
  }
  ... on ComponentSectionsTable {
    ...Table
  }
  ... on ComponentSectionsAccordion {
    title
    flatText {
      ...FlatText
    }
    tableRows {
      ...TableRow
    }
    forms {
      category
      type
    }
  }
  ... on ComponentSectionsEventDetails {
    ...EventDetails
  }
  ... on ComponentSectionsDivider {
    shown
  }
  ... on ComponentSectionsColumnedText {
    title
    content
  }
  ... on ComponentSectionsExternalLinks {
    title
    externalLinks {
      ...ExternalLink
    }
    descriptions {
      ...FlatText
    }
  }
  ... on ComponentSectionsCta {
    title
    url
  }

  ... on ComponentSectionsVideo {
    id
    youtube_url
    media {
      data {
        attributes {
          url
        }
      }
    }
  }

  ... on ComponentSectionsDocuments {
    id
    title
    basicDocuments {
      data {
        ...BasicDocument
      }
    }
    moreLink {
      ...PageLink
    }
  }

  ... on ComponentSectionsLocalityDetails {
    id
    localityTitle
    localityDescription
    localityLongitude
    localityLatitude
    displayOnHomePage
    isMainLocality
    localityCoverImage {
      data {
        id
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
        }
      }
    }
    localityMap {
      data {
        id
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
        }
      }
    }
    localityAddress {
      id
      title
      navigateTo
    }
    localitySections {
      id
      localitySectionTitle
      localitySectionPhone
      localitySectionEmail
      localitySectionDescription
      isMainSection
      openingHoursMondayFrom
      openingHoursMondayTo
      openingHoursTuesdayFrom
      openingHoursTuesdayTo
      openingHoursWednesdayFrom
      openingHoursWednesdayTo
      openingHoursThursdayFrom
      openingHoursThursdayTo
      openingHoursFridayFrom
      openingHoursFridayTo
      openingHoursSaturdayFrom
      openingHoursSaturdayTo
      openingHoursSundayFrom
      openingHoursSundayTo
    }
    localityServices {
      id
      page {
        data {
          ...BasePageFields
        }
      }
    }
  }

  ... on ComponentSectionsGallery {
    id
    Gallery {
      id
      Description
      Photo {
        data {
          id
          attributes {
            name
            width
            height
            url
            createdAt
            hash
            mime
            provider
            size
            updatedAt
          }
        }
      }
    }
  }
}

fragment FlatText on ComponentAccordionItemsFlatText {
  category
  content
}

fragment TableRow on ComponentAccordionItemsTableRow {
  accordionCategory
  tableCategory
  label
  value
  valueAlign
}

fragment Table on ComponentSectionsTable {
  primaryTitle
  secondaryTitle
  rows {
    label
    value
    valueAlign
  }
}

fragment Subpages on ComponentSectionsSubpages {
  title
  subpages {
    id
    title
    description
    url
    page {
      data {
        ...BasePageFields
      }
    }
  }
}

fragment ExternalLink on ComponentBlocksExternalLink {
  category
  title
  url
}

fragment AccordionItem on ComponentBlocksAccordionItem {
  id
  label
  content
}

fragment PageLink on ComponentBlocksPageLink {
  title
  url
  page {
    data {
      ...BasePageFields
    }
  }
}

fragment Localization on PageEntity {
  id
  attributes {
    slug
    locale
  }
}

fragment BasePageFields on PageEntity {
  id
  attributes {
    title
    slug
    createdAt
    updatedAt
  }
}

fragment EventDetails on ComponentSectionsEventDetails {
  id
  eventTitle
  eventDescription
  eventCategory {
    data {
      id
      attributes {
        title
        createdAt
        updatedAt
      }
    }
  }
  eventLocality {
    data {
      id
      attributes {
        title
        navigateTo
        eventAddress
        createdAt
        updatedAt
      }
    }
  }
  dateFrom
  dateTo
  price
  guests {
    id
    name
    surname
    avatar {
      data {
        id
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
          alternativeText
        }
      }
    }
  }
  # partners {
  #   id
  #   title
  #   image {
  #     name
  #     width
  #     height
  #     url
  #     createdAt
  #     hash
  #     id
  #     mime
  #     provider
  #     size
  #     updatedAt
  #     alternativeText
  #   }
  # }
  eventTags {
    data {
      id
      attributes {
        title
        slug
        createdAt
        publishedAt
        updatedAt
      }
    }
  }
  eventCoverImage {
    data {
      attributes {
        name
        width
        height
        url
        createdAt
        hash
        mime
        provider
        size
        updatedAt
        alternativeText
      }
    }
  }
}

fragment SectionLinkPage on PageEntity {
  id
  attributes {
    layout
    title
    slug
    createdAt
    updatedAt
    date_added
    listingImage {
      data {
        attributes {
          name
          width
          height
          url
          createdAt
          hash
          mime
          provider
          size
          updatedAt
        }
      }
    }
    sections {
      __typename
      ... on ComponentSectionsEventDetails {
        ...EventDetails
      }
    }
  }
}
fragment PageEvent on PageEntity {
  id
  attributes {
    slug
    title
    createdAt
    updatedAt
    date_added
    listingImage {
      data {
        attributes {
          name
          url
          createdAt
        }
      }
    }
    layout
    sections {
      ...SectionsEvent
    }
    locale
    Seo {
      id
      metaTitle
      metaDescription
      keywords
      metaRobots
      metaViewport
      canonicalURL
    }
  }
}

fragment SectionsEvent on PageSectionsDynamicZone {
  __typename
  ... on ComponentSectionsEventDetails {
    ...EventDetailsEvent
  }
}

fragment EventDetailsEvent on ComponentSectionsEventDetails {
  id
  eventTitle
  eventCategory {
    data {
      id
      attributes {
        title
        createdAt
        updatedAt
      }
    }
  }
  eventLocality {
    data {
      id
      attributes {
        title
        navigateTo
        eventAddress
        createdAt
        updatedAt
      }
    }
  }
  dateFrom
  dateTo
  price
  eventTags {
    data {
      id
      attributes {
        title
        slug
        createdAt
        publishedAt
        updatedAt
      }
    }
  }
}

query EventProperties($locale: I18NLocaleCode!) {
  eventCategories(locale: $locale) {
    data {
      id
      attributes {
        title
        createdAt
        updatedAt
      }
    }
  }
  eventLocalities(locale: $locale) {
    data {
      id
      attributes {
        title
        navigateTo
        createdAt
        updatedAt
      }
    }
  }
  eventTags(locale: $locale) {
    data {
      id
      attributes {
        title
        slug
        createdAt
        publishedAt
        updatedAt
      }
    }
  }
}

fragment Pagination on Pagination {
  total
  page
  pageSize
  pageCount
}